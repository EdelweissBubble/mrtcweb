<template>
    <div id="chat-panel" class='chat-panel'>

        <div class='title-panel'>
            <span class='title-chat'>Chat</span>
        </div>

        <div ref="chat" class='chat-history'>
            <div v-for="(item,index) in msgs">
                <div class='bubble-left' v-show="item.type == 1">
                    <div class='bubble-head'>
                        <!--<Icon component={UserIcon} />-->
                    </div>
                    <div class='bubble-msg'>
                        <p style="text-align: left" class="sender-name">{{item.name}}</p>
                        <div class='bubble-msgword'>
                            <p class='pl'>
                                {{item.msg}}
                            </p>
                        </div>
                    </div>
                </div>

                <div class='bubble-right' v-show="item.type == 2">
                    <div class='bubble-msg'>
                        <p style="text-align: right" class="sender-name">{{item.name}}</p>
                        <div class='bubble-msgword'>
                            <p class='pr'>
                                {{item.msg}}
                            </p>
                        </div>
                    </div>
                    <div class='bubble-head'>
                        <!--<Icon component={UserIcon} />-->
                    </div>

                </div>

                <div class='bubble-middle' v-show="item.type == 3">
                    <div class='bubble-msg'>
                        <div class='bubble-msgword-middle'>
                            <p class='pm'>
                                {{item.msg}}
                            </p>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class='chat-input'>
            <a-input placeholder="Basic usage" v-model="message"/>
            <a-button style="margin-left: 5px" icon='message' @click="sendMsg()"/>
        </div>
    </div>
</template>

<script>
    export default {
        name: "Chat",
        props: ['client',"config"],
        data() {
            return {
                msgs: [],
                message: ""
            }
        },
        created() {
        },
        mounted() {
        },
        methods: {
            sendMsg() {
                if(this.message == ""){
                    return
                }
                let mesg = {
                    msg: this.message,
                    name: this.config.user.name,
                    icon: "",
                    id: this.client.uid,
                    type: 1
                }
                this.msgs.push(mesg);
                console.log("msg", mesg)
                this.message = ""
                this.client.broadcast(mesg)
            },
            addMsg(msg){
                msg.type = 2
                this.msgs.push(msg);
            }
        }

    }
</script>

<style scoped>


    .title-chat {
        font-size: 16px;
        color: #fff;
        margin-left: 10px;
    }

    .chat-input {
        display: flex;
        flex-direction: row;
        width: 320px;
        padding: 10px;
        border-top-width: 1px;
        border-top-style: solid;
        border-top-color: #888888;
        padding-bottom: 20px;
    }

    .bubble-left {
        display: flex;
        flex-direction: row;
        justify-content: flex-start;
        margin-bottom: 16px;
        margin-left: 5px;
    }

    .bubble-right {
        display: flex;
        flex-direction: row;
        justify-content: flex-end;
        margin-bottom: 16px;
        margin-right: 16px;
    }

    .bubble-middle {
        display: flex;
        flex-direction: row;
        justify-content: center;
        margin-bottom: 16px;
        margin-right: 5px;
    }

    .bubble-head {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 32px;
        height: 32px;
        background-color: #fff;
    }

    .bubble-head i {
        font-size: 24px;
        color: #909090;
    }

    .sender-name {
        color: #fff;
    }

    .bubble-msg {
        padding: 0px 10px;
    }

    .bubble-msgword {
        background-color: #fff;
        display: inline-block;
        margin-top: 6px;
        padding-top: 8px;
        padding-bottom: 8px;
        padding-left: 10px;
        padding-right: 10px;
        border-radius: 4px;
    }

    .bubble-msgword-middle {
        background-color: #fafafa;
        display: inline-block;
        margin-top: 6px;
        padding-top: 8px;
        padding-bottom: 8px;
        padding-left: 10px;
        padding-right: 10px;
        border-radius: 4px;
    }

    .pl {
        color: #262626;
        font-size: 14px;
        font-weight: 300;
        margin: 0px;
        text-align: left;
        word-break: break-all;
    }

    .pr {
        color: #262626;
        font-size: 14px;
        font-weight: 300;
        margin: 0px;
        text-align: right;
        word-break: break-all;
    }

    .pm {
        color: #8c8c8c;
        font-size: 12px;
        font-weight: 300;
        font-style: italic;
        margin: 0px;
        text-align: center;
        word-break: break-all;
    }

    .chat-panel {
        display: flex;
        flex-direction: column;
        flex: 1;
        overflow: hidden;
        background-color: #555555;
    }

    .title-panel {
        display: flex;
        align-items: center;
        height: 36px;
        background-color: #555555;
        padding-top: 4px;
        border-bottom-width: 1px;
        border-bottom-style: solid;
        border-bottom-color: #888888;
    }

    .chat-history {
        overflow-y: auto;
        overflow-x: hidden;
        flex: 1;
    }

    .chatbubble-wrapper {
        margin-top: 10px;
        margin-bottom: 10px;
        overflow: auto;
        position: relative;
    }
</style>
